<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ® í•™ìŠµ ê²Œì„ ì„ íƒ</title>
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .game-select-container {
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
        }

        .game-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .game-header h1 {
            color: #FF6B9D;
            font-size: 32px;
            margin-bottom: 10px;
        }

        .game-header p {
            color: #666;
            font-size: 18px;
        }

        .story-info {
            background: linear-gradient(135deg, #FFF9F0 0%, #FFE5EC 100%);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
        }

        .story-info h2 {
            color: #333;
            font-size: 24px;
            margin-bottom: 10px;
        }

        .learning-words-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        .word-badge {
            background: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            color: #FF6B9D;
            font-weight: 600;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .game-cards {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .game-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 3px solid transparent;
        }

        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
            border-color: #FF6B9D;
        }

        .game-card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .game-icon {
            font-size: 48px;
        }

        .game-card h3 {
            font-size: 24px;
            color: #333;
            margin: 0;
        }

        .game-card p {
            color: #666;
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .game-features {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .feature-tag {
            background: #FFF9F0;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 13px;
            color: #FFA500;
            font-weight: 500;
        }

        .start-button {
            background: linear-gradient(135deg, #FF6B9D 0%, #FFA500 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
        }

        .start-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255, 107, 157, 0.4);
        }

        .back-button {
            display: inline-block;
            background: white;
            color: #FF6B9D;
            border: 2px solid #FF6B9D;
            padding: 12px 30px;
            border-radius: 25px;
            text-decoration: none;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .back-button:hover {
            background: #FF6B9D;
            color: white;
        }

        .button-container {
            text-align: center;
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .game-select-container {
                padding: 15px;
                margin: 20px auto;
            }

            .game-header h1 {
                font-size: 24px;
            }

            .game-header p {
                font-size: 16px;
            }

            .story-info h2 {
                font-size: 20px;
            }

            .game-card {
                padding: 20px;
            }

            .game-card h3 {
                font-size: 20px;
            }

            .game-card p {
                font-size: 14px;
            }

            .game-icon {
                font-size: 36px;
            }
        }

        .coming-soon {
            opacity: 0.6;
            pointer-events: none;
        }

        .coming-soon-badge {
            background: #FFE5EC;
            color: #FF6B9D;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="game-select-container">
        <div class="game-header">
            <h1>ğŸ® í•™ìŠµ ê²Œì„ ì„ íƒ</h1>
            <p>ì¬ë¯¸ìˆëŠ” ê²Œì„ìœ¼ë¡œ ë‹¨ì–´ë¥¼ ë°°ì›Œë³´ì„¸ìš”!</p>
        </div>

        <div class="story-info">
            <h2 id="storyTitle">ğŸ“– ë™í™”ì±… ì œëª©</h2>
            <p>í•™ìŠµí•  ë‹¨ì–´ë“¤:</p>
            <div class="learning-words-preview" id="wordsPreview">
                <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
            </div>
        </div>

        <div class="game-cards">
            <!-- ê²Œì„ 1: ë‹¨ì–´ ì¹´ë“œ ë§¤ì¹­ -->
            <div class="game-card" onclick="startGame('memory-match')">
                <div class="game-card-header">
                    <div class="game-icon">ğŸƒ</div>
                    <div>
                        <h3>ë‹¨ì–´ ì¹´ë“œ ë§¤ì¹­</h3>
                    </div>
                </div>
                <p>ì¹´ë“œë¥¼ ë’¤ì§‘ì–´ì„œ ë‹¨ì–´ì™€ ê·¸ë¦¼ì˜ ì§ì„ ë§ì¶°ë³´ì„¸ìš”! ê¸°ì–µë ¥ê³¼ ì§‘ì¤‘ë ¥ì„ í‚¤ìš¸ ìˆ˜ ìˆì–´ìš”.</p>
                <div class="game-features">
                    <span class="feature-tag">â±ï¸ ì‹œê°„ ì¸¡ì •</span>
                    <span class="feature-tag">â­ ì ìˆ˜ ê¸°ë¡</span>
                    <span class="feature-tag">ğŸ¯ ë‚œì´ë„ ì¡°ì ˆ</span>
                </div>
                <button class="start-button">ğŸ® ê²Œì„ ì‹œì‘í•˜ê¸° â†’</button>
            </div>

            <!-- ê²Œì„ 2: ë‹¨ì–´ í€´ì¦ˆ (ì¤€ë¹„ ì¤‘) -->
            <div class="game-card coming-soon">
                <div class="game-card-header">
                    <div class="game-icon">ğŸ“</div>
                    <div>
                        <h3>ë‹¨ì–´ í€´ì¦ˆ <span class="coming-soon-badge">ì¤€ë¹„ ì¤‘</span></h3>
                    </div>
                </div>
                <p>ë‹¨ì–´ì˜ ëœ»ì„ ë³´ê³  ì •ë‹µì„ ë§í˜€ë³´ì„¸ìš”! 4ì§€ì„ ë‹¤í˜• í€´ì¦ˆë¡œ ë‹¨ì–´ë¥¼ ì¬ë¯¸ìˆê²Œ ë°°ìš¸ ìˆ˜ ìˆì–´ìš”.</p>
                <div class="game-features">
                    <span class="feature-tag">ğŸ“Š 8ë¬¸ì œ</span>
                    <span class="feature-tag">âœ… ì •ë‹µ í”¼ë“œë°±</span>
                    <span class="feature-tag">ğŸ’¯ ì ìˆ˜ ê³„ì‚°</span>
                </div>
                <button class="start-button" disabled>ğŸ”’ ì¤€ë¹„ ì¤‘...</button>
            </div>

            <!-- ê²Œì„ 3: ë‹¨ì–´ ë§Œë“¤ê¸° (ì¤€ë¹„ ì¤‘) -->
            <div class="game-card coming-soon">
                <div class="game-card-header">
                    <div class="game-icon">âœï¸</div>
                    <div>
                        <h3>ë‹¨ì–´ ë§Œë“¤ê¸° <span class="coming-soon-badge">ì¤€ë¹„ ì¤‘</span></h3>
                    </div>
                </div>
                <p>í©ì–´ì§„ ê¸€ìë¥¼ ìˆœì„œëŒ€ë¡œ ì¡°í•©í•˜ì—¬ ë‹¨ì–´ë¥¼ ì™„ì„±í•´ë³´ì„¸ìš”! ë‹¨ì–´ì˜ êµ¬ì¡°ë¥¼ ì´í•´í•  ìˆ˜ ìˆì–´ìš”.</p>
                <div class="game-features">
                    <span class="feature-tag">ğŸ”¤ ê¸€ì ì¡°í•©</span>
                    <span class="feature-tag">ğŸ’¡ íŒíŠ¸ ì œê³µ</span>
                    <span class="feature-tag">ğŸ“± í„°ì¹˜ ì§€ì›</span>
                </div>
                <button class="start-button" disabled>ğŸ”’ ì¤€ë¹„ ì¤‘...</button>
            </div>
        </div>

        <div class="button-container">
            <a href="#" class="back-button" id="backButton">â† ë™í™”ì±…ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
        </div>
    </div>

    <script>
        // URLì—ì„œ ë™í™”ì±… ID ê°€ì ¸ì˜¤ê¸°
        const urlParams = new URLSearchParams(window.location.search);
        const storyId = urlParams.get('story');

        // ë™í™”ì±… ë°ì´í„° ë¡œë“œ
        async function loadStoryData() {
            try {
                const response = await fetch(`/api/storybooks/${storyId}`);
                const story = await response.json();

                // ì œëª© ì„¤ì •
                document.getElementById('storyTitle').textContent = `ğŸ“– ${story.title}`;

                // í•™ìŠµ ë‹¨ì–´ ë¯¸ë¦¬ë³´ê¸° ìƒì„±
                const wordsPreview = document.getElementById('wordsPreview');
                if (story.learningWords && story.learningWords.length > 0) {
                    story.learningWords.forEach(wordData => {
                        const badge = document.createElement('span');
                        badge.className = 'word-badge';
                        badge.textContent = wordData.word;
                        wordsPreview.appendChild(badge);
                    });
                } else {
                    wordsPreview.innerHTML = '<p style="color: #999;">í•™ìŠµ ë‹¨ì–´ê°€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.</p>';
                }

                // ë’¤ë¡œ ê°€ê¸° ë²„íŠ¼ ì„¤ì •
                document.getElementById('backButton').href = `/reader/${storyId}`;
            } catch (error) {
                console.error('ë™í™”ì±… ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                alert('ë™í™”ì±… ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        // ê²Œì„ ì‹œì‘
        function startGame(gameType) {
            if (gameType === 'memory-match') {
                window.location.href = `/games/memory-match?story=${storyId}`;
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        if (storyId) {
            loadStoryData();
        } else {
            alert('ë™í™”ì±… IDê°€ ì—†ìŠµë‹ˆë‹¤.');
            window.location.href = '/';
        }
    </script>
</body>
</html>
